# Парсер онлайн-библиотеки [tululu](https://tululu.org)

Скрипт скачивает:

- Все книги на нужных страницах и сохраняет в папке files/books
- Картинки этих книг в папке filese/images
- Файл описание в формате json в files/parse_tululu_category.py

## Окружение

### Требования к установке

Python3 должен быть уже установлен. Затем используйте pip (или pip3, есть конфликт с Python2) для установки
зависимостей:

```bash
pip install -r requirements.txt
``` 

### Функция get_books_links

Принимает номер страницы, и возвращает список со ссылками на книги на данной странице.

### Функция get_book_with_description

Принимает ссылку на книгу, название общей папки для скачивания всех файлов, флаг скачивать ли картинки, флаг скачивать
ли текст книги. Скачивает книгу и картинку, если флаги были указаны, и создает описание книги(состоит из названия,
автора, картинки, книги , комментариев, жанров). Возвращает описание книги.

### Функция parse_book_page

Принимает номер книги и собирает с сайта данные о книге.

### Функция download_txt

Принимает ссылку на книгу, имя(которым назвать эту книгу), название общей папки для скачивания всех файлов и название
папки(куда необходимо сохранить книгу). Скачивает книгу. Возвращает местоположение файла.

### Функция download_image

Принимает ссылку на книгу, имя(которым назвать обложку), название общей папки для скачивания всех файлов и название
папки(куда необходимо сохранить обложку). Скачивает обложку. Возвращает местоположение файла.

### Функция check_for_redirect

Принимает ответ с запроса, поднимает исключение если был редирект.

## Запуск скрипта для скачивания книг

Запуск на Linux(Python 3) или Windows:

Для скачивания без [argparse](https://docs.python.org/3/library/argparse.html):

В файле parse_tululu_category.py изменить default в start_page и end_page на нужное начало и конец скачивания книг

```bash
$ python parse_tululu_category.py
```

Для скачивания с [argparse](https://docs.python.org/3/library/argparse.html):

`--start_page` - Страница начала скачивания книг

`--end_page` - Страница конца скачивания книг

`--dest_folder` - Путь к каталогу с результатами парсинга: картинкам, книгам, JSON

`--skip_imgs` - Не скачивать картинки

`--skip_txt` - Не скачивать книги

При выполнении следующего скрипта, будут скачаны книги с 20 по 30 страницу, картинки этих книг не будут скачаны.

```bash
$ python parse_tululu_category.py  --start_page 20 --end_page 30 --skip_imgs
```

### Цель проекта

Скрипт написан в образовательных целях на онлайн-курсе [Devman](dvmn.org)
